<!doctype html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Výpočet spotřeby chemické malty (FIXED)</title>
<style>
  :root { --gap: 12px; --pad: 14px; }
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; line-height: 1.45; margin: 0; background:#f6f7fb; color:#111; }
  .wrap { max-width: 980px; margin: 32px auto; padding: 0 16px; }
  h1 { font-size: 1.6rem; margin: 0 0 12px; }
  .grid { display: grid; gap: var(--gap); grid-template-columns: 1.1fr .9fr; }
  @media (max-width: 900px){ .grid{ grid-template-columns: 1fr; } }
  .card { background: #fff; padding: var(--pad); border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,.06); }
  label { display:block; font-size:.9rem; margin-bottom:6px; color:#333; }
  input, select { width: 100%; padding: 10px 12px; border:1px solid #d5d7de; border-radius: 10px; background:#fff; font-size: 1rem; }
  .row { display:flex; gap: var(--gap); align-items: center; }
  .small { font-size: .9rem; color:#444; }
  .results { font-size:1.05rem; }
  .results b { font-size:1.25rem; }
  .hline { height:1px; background:#eceef3; margin:12px 0; }
  .warn { color:#b00020; font-size:.9rem; display:none; }
</style>
</head>
<body>
<div class="wrap">
  <h1>Výpočet spotřeby chemické malty</h1>
  <div class="grid">
    <div class="card">
      <div class="row">
        <div style="flex: 1">
          <label for="pouziti">Použití</label>
          <select id="pouziti"></select>
        </div>
        <div id="sitkoWrap" style="flex:1; display:none">
          <label for="sitko">Sítko</label>
          <select id="sitko"></select>
        </div>
      </div>

      <div class="row">
        <div style="flex:1">
          <label for="sroub">Kotevní šroub / výztuž</label>
          <select id="sroub"></select>
        </div>
        <div style="flex:1">
          <label for="prumer">Průměr vrtaného otvoru [mm]</label>
          <select id="prumer"></select>
        </div>
      </div>

      <div class="row">
        <div style="flex:1">
          <label for="hloubka">Hloubka vrtání [mm]</label>
          <div id="hloubkaBox"></div>
        </div>
        <div style="flex:1">
          <label for="kotev">Počet kotev [ks]</label>
          <input id="kotev" type="number" min="1" step="1" value="10">
        </div>
      </div>

      <div class="row">
        <div style="flex:1">
          <label for="kartuse">Volba kartuše</label>
          <select id="kartuse"></select>
        </div>
        <div style="flex:1">
          <label for="rezerva">Rezerva</label>
          <select id="rezerva">
            <option>0 %</option>
            <option>5 %</option>
            <option selected>10 %</option>
            <option>15 %</option>
            <option>20 %</option>
            <option>25 %</option>
            <option>30 %</option>
          </select>
        </div>
      </div>

      <p id="warn" class="warn"></p>
    </div>

    <div class="card results">
      <div class="small">Výsledky</div>
      <p>Objem malty na 1 kotvu: <b><span id="objem1">–</span> ml</b></p>
      <p>Celkový objem malty + rez.: <b><span id="objem">–</span> ml</b></p>
      <p>Počet kotev na 1 kartuši: <b><span id="pocet">–</span> ks</b></p>
      <p>Požadovaný počet kartuší: <b><span id="kartusi">–</span> ks</b></p>
    </div>
  </div>
</div>

<script>
(function(){
  const scenare = [
    'Kotevní šroub v plném materiálu - bez sítka',
    'Kotevní šroub v děrovaném zdivu - se sítkem',
    'Kotevní šroub v pórobetonu - kuželový otvor s PBB',
    'Kotevní pouzdro s vnitřním závitem',
    'Betonářská výztuž',
    'FHB II-AL',
    'FHB II-AS'
  ];
  const sroubyPlny = ['M8','M10','M12','M16','M20','M24','M30'];
  const d0Plny = { M8:10, M10:12, M12:14, M16:18, M20:24, M24:28, M30:35 };
  const StPlny = { M8:36.6, M10:58, M12:84.3, M16:157, M20:245, M24:353, M30:561 };

  const sitkoInfo = {
    'FIS H 12x50 K':  { katalog:'41900', d0:12, hl:55,  V1:10000,  sroub:'M6-M8' },
    'FIS H 12x85 K':  { katalog:'41901', d0:12, hl:90,  V1:20000,  sroub:'M6-M8' },
    'FIS H 16x85 K':  { katalog:'41902', d0:16, hl:90,  V1:24000,  sroub:'M8-M10' },
    'FIS H 16x130 K': { katalog:'41903', d0:16, hl:135, V1:30000,  sroub:'M8-M10' },
    'FIS H 20x85 K':  { katalog:'41904', d0:20, hl:90,  V1:30000,  sroub:'M12-M16' },
    'FIS H 20x130 K': { katalog:'46703', d0:20, hl:135, V1:50000,  sroub:'M12-M16' },
    'FIS H 20x200 K': { katalog:'46704', d0:20, hl:205, V1:80000,  sroub:'M12-M16' },
    'FIS H 12x1000 L':{ katalog:'50598', d0:12, coef:240, sroub:'M6-M8' },
    'FIS H 16x1000 L':{ katalog:'50599', d0:16, coef:280, sroub:'M10-M12' },
    'FIS H 22x1000 L':{ katalog:'45301', d0:22, coef:400, sroub:'M12-M16' },
    'UPM-SH 30X1000 L':{ katalog:'645', d0:30, coef:520, sroub:'M16-M24' }
  };
  const sitka = Object.keys(sitkoInfo);

  const sroubyPBB = ['M8','M10','M12'];
  const pouzdroInfo = {
    'RG 8 x 75 M5 I':   { katalog:'48221', d0:10, hl:75,  V1:6000 },
    'RG 10 x 75 M6 I':  { katalog:'48222', d0:12, hl:75,  V1:6000 },
    'RG 12 x 90 M8 I':  { katalog:'50552', d0:14, hl:90,  V1:6000 },
    'RG 16 x 90 M10 I': { katalog:'50553', d0:18, hl:90,  V1:8000 },
    'RG 18 x 125 M12 I':{ katalog:'50562', d0:20, hl:125, V1:12000 },
    'RG 22 x 160 M16 I':{ katalog:'50563', d0:24, hl:160, V1:16000 },
    'RG 28 x 200 M20 I':{ katalog:'50564', d0:32, hl:200, V1:48000 }
  };
  const pouzdra = Object.keys(pouzdroInfo);

  const sroubyRebar = ['ø8','ø10','ø12','ø14','ø16','ø20','ø22','ø24','ø25','ø26','ø28','ø30','ø32','ø34','ø36','ø40'];
  const rebarHole = {
    'ø8':[10,12],'ø10':[12,14],'ø12':[14,16],
    'ø14':[18],'ø16':[20],'ø20':[25],'ø22':[30],'ø24':[30],'ø25':[30],
    'ø26':[35],'ø28':[35],'ø30':[40],'ø32':[40],'ø34':[40],'ø36':[45],'ø40':[55]
  };

  const fhbALInfo = {
    'M8x60':   { d0:10, hl:75,  V1:6000 },
    'M10x95':  { d0:12, hl:110, V1:10000 },
    'M12x100': { d0:14, hl:115, V1:14000 },
    'M12x120': { d0:14, hl:135, V1:14000 },
    'M16x125': { d0:18, hl:140, V1:22000 },
    'M16x145': { d0:18, hl:160, V1:26000 },
    'M16x160': { d0:18, hl:175, V1:26000 },
    'M20x210': { d0:25, hl:235, V1:66000 },
    'M24x210': { d0:25, hl:235, V1:66000 }
  };
  const fhbAL = Object.keys(fhbALInfo);

  const fhbASInfo = {
    'M10x60': { d0:10, hl:75,  V1:6000 },
    'M10x75': { d0:10, hl:90,  V1:8000 },
    'M12x75': { d0:12, hl:90,  V1:8000 },
    'M16x95': { d0:16, hl:110, V1:16000 },
    'M20x170':{ d0:25, hl:190, V1:52000 },
    'M24x170':{ d0:25, hl:190, V1:52000 }
  };
  const fhbAS = Object.keys(fhbASInfo);

  const kartuseInfo = {
    'FIS VL 300': { V:280,  kat:'538583' },
    'FIS VL 410': { V:390,  kat:'538584' },
    'FIS VL HIGHSPEED 300': { V:280, kat:'538585' },
    'FIS VL HIGHSPEED 410': { V:390, kat:'538586' },
    'FIS V Zero': { V:280,  kat:'562064' },
    'FIS V 360':  { V:340,  kat:'43994' },
    'FIS V Plus 360': { V:340, kat:'558762' },
    'FIS VW 360': { V:340,  kat:'43997' },
    'FIS VW Plus 360': { V:340, kat:'558768' },
    'FIS P 300':  { V:280,  kat:'51061' },
    'FIS EM Plus 390': { V:370, kat:'544176' },
    'FIS EM Plus 585': { V:565, kat:'544165' },
    'FIS EM Plus 1500': { V:1470, kat:'544167' },
    'FIS HB 360 S': { V:340, kat:'562660' },
    'FIS SB 390': { V:370, kat:'520555' },
    'FIS SB 585': { V:565, kat:'520526' }
  };

  const $pouziti = document.getElementById('pouziti');
  const $sitkoWrap = document.getElementById('sitkoWrap');
  const $sitko = document.getElementById('sitko');
  const $sroub = document.getElementById('sroub');
  const $prumer = document.getElementById('prumer');
  const $hloubkaBox = document.getElementById('hloubkaBox');
  const $kotev = document.getElementById('kotev');
  const $kartuse = document.getElementById('kartuse');
  const $rezerva = document.getElementById('rezerva');
  const $warn = document.getElementById('warn');
  const $objem1 = document.getElementById('objem1');
  const $objem = document.getElementById('objem');
  const $pocet = document.getElementById('pocet');
  const $kartusi = document.getElementById('kartusi');

  function fillOptions(select, items, opts={}) {
    const { disabled=false, value=null } = opts;
    select.innerHTML = items.map(v => '<option>'+v+'</option>').join('');
    select.disabled = !!disabled;
    if (value!==null) { select.value = value; }
  }
  function makeInput(id, val){ return '<input id="'+id+'" type="number" min="1" step="1" value="'+val+'">'; }
  function makeSelect(id, items, value){ return '<select id="'+id+'">'+ items.map(v=>'<option>'+v+'</option>').join('') + '</select>'; }

  function init(){
    fillOptions($pouziti, scenare);
    fillOptions($kartuse, Object.keys(kartuseInfo));
    setScenario($pouziti.value || scenare[0]);

    $pouziti.addEventListener('change', () => { setScenario($pouziti.value); calc(); });
    $sitko.addEventListener('change', calc);
    $sroub.addEventListener('change', () => {
      if($pouziti.value === 'Betonářská výztuž'){
        fillOptions($prumer, rebarHole[$sroub.value] || [10], { disabled: (rebarHole[$sroub.value]||[]).length<=1 });
      }
      calc();
    });
    $prumer.addEventListener('change', calc);
    $kotev.addEventListener('input', calc);
    $rezerva.addEventListener('change', calc);
    $kartuse.addEventListener('change', calc);
    document.addEventListener('input', (e)=>{ if(e.target && e.target.id==='hloubka'){ calc(); } });
    calc();
  }

  function setScenario(name){
    if(name==='Kotevní šroub v plném materiálu - bez sítka'){
      $sitkoWrap.style.display='none';
      fillOptions($sroub, sroubyPlny);
      fillOptions($prumer, Object.values(d0Plny), { disabled:true });
      $prumer.value = d0Plny[$sroub.value] || 10;
      $hloubkaBox.innerHTML = makeInput('hloubka', 250);
    } else if(name==='Kotevní šroub v děrovaném zdivu - se sítkem'){
      $sitkoWrap.style.display='block';
      fillOptions($sitko, Object.keys(sitkoInfo));
      fillOptions($sroub, ['M6-M8','M8-M10','M10-M12','M12-M16','M16','M16-M24'], { disabled:true });
      fillOptions($prumer, [12,16,20,22,30], { disabled:true });
      $hloubkaBox.innerHTML = makeInput('hloubka', 250);
    } else if(name==='Kotevní šroub v pórobetonu - kuželový otvor s PBB'){
      $sitkoWrap.style.display='none';
      fillOptions($sroub, sroubyPBB);
      $hloubkaBox.innerHTML = makeSelect('hloubka', [75,95], 75);
      $prumer.innerHTML = '<option>–</option>'; $prumer.disabled = true;
    } else if(name==='Kotevní pouzdro s vnitřním závitem'){
      $sitkoWrap.style.display='none';
      fillOptions($sroub, pouzdra);
      fillOptions($prumer, [10,12,14,18,20,24,32], { disabled:true });
      $hloubkaBox.innerHTML = makeInput('hloubka', 250);
    } else if(name==='Betonářská výztuž'){
      $sitkoWrap.style.display='none';
      fillOptions($sroub, sroubyRebar);
      fillOptions($prumer, rebarHole[$sroub.value] || [10], { disabled: (rebarHole[$sroub.value]||[]).length<=1 });
      $hloubkaBox.innerHTML = makeInput('hloubka', 250);
    } else if(name==='FHB II-AL'){
      $sitkoWrap.style.display='none';
      fillOptions($sroub, Object.keys(fhbALInfo));
      fillOptions($prumer, [10,12,14,18,25], { disabled:true });
      $hloubkaBox.innerHTML = makeInput('hloubka', 250);
    } else if(name==='FHB II-AS'){
      $sitkoWrap.style.display='none';
      fillOptions($sroub, Object.keys(fhbASInfo));
      fillOptions($prumer, [10,12,16,25], { disabled:true });
      $hloubkaBox.innerHTML = makeInput('hloubka', 250);
    }
  }

  function calc(){
    const scen = $pouziti.value;
    const $hl = document.getElementById('hloubka');

    let V1_ml = 0;
    let d0 = parseFloat($prumer.value);
    let hl = parseFloat($hl ? $hl.value : '0');
    let k = parseInt($kotev.value || '0', 10);

    $warn.style.display='none'; $warn.textContent='';

    if(scen==='Kotevní šroub v plném materiálu - bez sítka'){
      const s = $sroub.value;
      d0 = d0Plny[s];
      const St = StPlny[s];
      const Svrtu = Math.PI*Math.pow(d0/2,2);
      V1_ml = (Svrtu - St) * hl / 1000;
    } else if(scen==='Kotevní šroub v děrovaném zdivu - se sítkem'){
      const info = sitkoInfo[$sitko.value];
      if(info.coef){
        V1_ml = (info.coef * hl) / 1000;
        d0 = info.d0;
      } else {
        V1_ml = info.V1 / 1000;
        d0 = info.d0;
        if($hl) $hl.value = info.hl;
        hl = info.hl;
      }
    } else if(scen==='Kotevní šroub v pórobetonu - kuželový otvor s PBB'){
      V1_ml = (hl == 95 ? 40 : 30);
      d0 = NaN;
    } else if(scen==='Kotevní pouzdro s vnitřním závitem'){
      const info = pouzdroInfo[$sroub.value];
      V1_ml = info.V1 / 1000;
      d0 = info.d0;
      if($hl) $hl.value = info.hl;
      hl = info.hl;
    } else if(scen==='Betonářská výztuž'){
      const dn = parseFloat($sroub.value.replace('ø',''));
      const St = Math.PI * Math.pow(dn,2) / 4;
      const Svrtu = Math.PI * Math.pow(d0/2,2);
      if (d0 <= dn) { $warn.textContent = 'Průměr vrtaného otvoru musí být větší než průměr výztuže.'; $warn.style.display='block'; }
      V1_ml = (Svrtu - St) * hl / 1000;
    } else if(scen==='FHB II-AL'){
      const info = fhbALInfo[$sroub.value];
      V1_ml = info.V1 / 1000; d0 = info.d0; if($hl) $hl.value = info.hl; hl = info.hl;
    } else if(scen==='FHB II-AS'){
      const info = fhbASInfo[$sroub.value];
      V1_ml = info.V1 / 1000; d0 = info.d0; if($hl) $hl.value = info.hl; hl = info.hl;
    }

    let rezerva = 1;
    const rv = ($rezerva.value||'0').trim();
    if(rv==='5 %') rezerva=1.05; else if(rv==='10 %') rezerva=1.10; else if(rv==='15 %') rezerva=1.15;
    else if(rv==='20 %') rezerva=1.20; else if(rv==='25 %') rezerva=1.25; else if(rv==='30 %') rezerva=1.30;

    const kInfo = kartuseInfo[$kartuse.value] || { V: 280 };
    const Vk_ml = kInfo.V;

    const Vcelk_ml = k * V1_ml * rezerva;
    const pocetNaKartusi = Vk_ml / V1_ml / rezerva;
    const kartusi = Math.ceil(Vcelk_ml / Vk_ml);

    $objem1.textContent = isFinite(V1_ml) ? Math.round(V1_ml) : '–';
    $objem.textContent = isFinite(Vcelk_ml) ? Math.round(Vcelk_ml) : '–';
    $pocet.textContent = isFinite(pocetNaKartusi) ? Math.round(pocetNaKartusi) : '–';
    $kartusi.textContent = isFinite(kartusi) ? kartusi : '–';
  }

  init();
})();
</script>
</body>
</html>
